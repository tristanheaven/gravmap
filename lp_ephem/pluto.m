function rpluto = pluto(jdate)

% heliocentric coordinates of pluto

% heliocentric position vector of Pluto
% ecliptic and equinox of J2000

% input
    
%  jdate = julian date

% output

%  rpluto = position vector of Pluto (kilometers)

% Orbital Mechanics with MATLAB

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

dtr = pi / 180;

pdata = [0;  0;  1; -19798886; 19848454; -5453098; -14974876;  66867334; 68955876
         0;  0;  2;    897499; -4955707;  3527363;   1672673; -11826086;  -333765
         0;  0;  3;    610820;  1210521; -1050939;    327763;   1593657; -1439953
         0;  0;  4;   -341639;  -189719;   178691;   -291925;    -18948;   482443
         0;  0;  5;    129027;   -34863;    18763;    100448;    -66634;   -85576
         0;  0;  6;    -38215;    31061;   -30594;    -25838;     30841;    -5765
         0;  1; -1;     20349;    -9886;     4965;     11263;     -6140;    22254
         0;  1;  0;     -4045;    -4904;      310;      -132;      4434;     4443
         0;  1;  1;     -5885;    -3238;     2036;      -947;     -1518;      641
         0;  1;  2;     -3812;     3011;       -2;      -674;        -5;      792
         0;  1;  3;      -601;     3468;     -329;      -563;       518;      518
         0;  2; -2;      1237;      463;      -64;        39;       -13;     -221
         0;  2; -1;      1086;     -911;      -94;       210;       837;     -494
         0;  2;  0;       595;    -1229;       -8;      -160;      -281;      616
         1; -1;  0;      2484;     -485;     -177;       259;       260;     -395
         1; -1;  1;       839;    -1414;       17;       234;      -191;     -396
         1;  0; -3;      -964;     1059;      582;      -285;     -3218;      370
         1;  0; -2;     -2303;    -1038;     -298;       692;      8019;    -7869
         1;  0; -1;      7049;      747;      157;       201;       105;    45637
         1;  0;  0;      1179;     -358;      304;       825;      8623;     8444
         1;  0;  1;       393;      -63;     -124;       -29;      -896;     -801
         1;  0;  2;       111;     -268;       15;         8;       208;     -122
         1;  0;  3;       -52;     -154;        7;        15;      -133;       65
         1;  0;  4;       -78;      -30;        2;         2;       -16;        1
         1;  1; -3;       -34;      -26;        4;         2;       -22;        7
         1;  1; -2;       -43;        1;        3;         0;        -8;       16
         1;  1; -1;       -15;       21;        1;        -1;         2;        9
         1;  1;  0;        -1;       15;        0;        -2;        12;        5
         1;  1;  1;         4;        7;        1;         0;         1;       -3
         1;  1;  3;         1;        5;        1;        -1;         1;        0
         2;  0; -6;         8;        3;       -2;        -3;         9;        5
         2;  0; -5;        -3;        6;        1;         2;         2;       -1
         2;  0; -4;         6;      -13;       -8;         2;        14;       10
         2;  0; -3;        10;       22;       10;        -7;       -65;       12
         2;  0; -2;       -57;      -32;        0;        21;       126;     -233
         2;  0; -1;       157;      -46;        8;         5;       270;     1068
         2;  0;  0;        12;      -18;       13;        16;       254;      155
         2;  0;  1;        -4;        8;       -2;        -3;       -26;       -2
         2;  0;  2;        -5;        0;        0;         0;         7;        0
         2;  0;  3;         3;        4;        0;         1;       -11;        4
         3;  0; -2;        -1;       -1;        0;         1;         4;      -14
         3;  0; -1;         6;       -3;        0;         0;        18;       35
         3;  0;  0;        -1;       -2;        0;         1;        13;        3];

% extract data and load arrays

pj(1:1:43) = pdata(1:9:387);
ps(1:1:43) = pdata(2:9:387);
pp(1:1:43) = pdata(3:9:387);
plona(1:1:43) = pdata(4:9:387);
plonb(1:1:43) = pdata(5:9:387);
plata(1:1:43) = pdata(6:9:387);
platb(1:1:43) = pdata(7:9:387);
prva(1:1:43) = pdata(8:9:387);
prvb(1:1:43) = pdata(9:9:387);

% fundamental time argument

tjd = (jdate - 2451545) / 36525;

% planetary longitudes

j = dtr * (34.35 + 3034.9057 * tjd);

s = dtr * (50.08 + 1222.1138 * tjd);

p = dtr * (238.96 + 144.96 * tjd);

% sum series

lonsum = 0;
latsum = 0;
rvsum = 0;

for i = 1:1:43
    
    alpha = pj(i) * j + ps(i) * s + pp(i) * p;
    
    salpha = sin(alpha);
    
    calpha = cos(alpha);

    lonsum = lonsum + plona(i) * salpha + plonb(i) * calpha;

    latsum = latsum + plata(i) * salpha + platb(i) * calpha;

    rvsum = rvsum + prva(i) * salpha + prvb(i) * calpha;
    
end

% heliocentric longitude (radians)

pl = dtr * (238.956785 + 144.96 * tjd + 0.000001 * lonsum);
  
% heliocentric latitude (radians)

pb = dtr * (-3.908202 + 0.000001 * latsum);

% heliocentric distance (kilometers)

pr = 149597870.691 * (40.7247248 + 0.0000001 * rvsum);

% heliocentric ecliptic position vector (kilometers)

rpluto(1) = pr * cos(pb) * cos(pl);
rpluto(2) = pr * cos(pb) * sin(pl);
rpluto(3) = pr * sin(pb);
